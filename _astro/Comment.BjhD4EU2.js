import{i as T}from"./if.BW1F5YaP.js";import{d as U,p as $,s as O,a as P,f as N,b as d,t as E,c as y,e as B,g as _,h as r,i as l,r as H,j as t,k as m,l as W}from"./render.oTo6VhDT.js";import{e as Y,b as M,s as q,r as F,i as G}from"./_sanity_client.CpwVv7lS.js";const K="$COMMENT_URL";async function Q(w,a,i,n,s){if(a.text.trim()){const c={text:a.text.trim(),username:a.username.trim()||"Anonymous",postId:i.postId};console.log(JSON.stringify(c));try{_(n,!0),await fetch(`${K.replace(/\/$/,"")}/api/create`,{method:"POST",body:JSON.stringify(c)}),l(s).unshift({...c,timestamp:new Date().toLocaleString()})}catch(b){console.error("Error posting comment:",b)}finally{_(n,!1),a.text=""}}}var V=W('<svg class="animate-spin h-4 w-4" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path></svg>'),X=N(`<div class="bg-blue-50/20 backdrop-blur-sm mb-4 border border-blue-400/40 rounded-xl p-4
        dark:bg-blue-950/80 dark:border-gray-700"><div class="flex justify-between items-center mb-3"><span class="font-semibold text-primary dark:text-background"> </span> <span class="text-blue-700/70 dark:text-blue-100 text-sm"> </span></div> <p class="text-gray-800/90 dark:text-white leading-relaxed"> </p></div>`),Z=N('<div class="max-w-6xl mx-auto px-4"><h2 class="text-primary dark:text-background text-2xl font-semibold mb-2">Leave a comment ...</h2> <div class="mb-5 p-4 max-w-2xl border border-blue-400/30 dark:border-gray-700 rounded-lg bg-blue-50/20 dark:bg-blue-950/60 backdrop-blur-sm"><input placeholder="Your name..." class="w-full mb-2.5 border border-blue-500/30 dark:border-gray-700 dark:bg-blue-950/80 dark:text-background rounded p-2.5 font-sans bg-fig backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/> <textarea placeholder="Write a comment..." rows="3" class="w-full border border-blue-500/30 dark:border-gray-700 dark:bg-blue-950/80 dark:text-background rounded p-2.5 resize-y font-sans bg-fig backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea> <button class="mt-2.5 px-4 py-2 bg-blue-500/80 text-white dark:text-blue-600 dark:font-semibold dark:bg-gray-200 border-none rounded cursor-pointer backdrop-blur-sm hover:bg-blue-700/80 dark:hover:bg-white disabled:bg-gray-400/50 dark:disabled:bg-gray-400 dark:disabled:text-blue-800  disabled:cursor-not-allowed flex items-center gap-2"><!> </button></div> <h3 class="text-xl text-primary dark:text-background font-semibold mb-5"> </h3> <div class="max-w-2xl"></div></div>');function ae(w,a){$(a,!0);let i=O(P([])),n=O(!1),s=P({username:"",text:"",timestamp:""});async function c(){try{const e=await q.fetch(`*[_type == "comment" && postId._ref == $postId] | order(timestamp desc) {
                    _id,
                    username,
                    text,
                    timestamp
                }`,{postId:a.postId});_(i,e.map(o=>({...o,timestamp:new Date(o.timestamp).toLocaleString()})),!0)}catch(e){console.error("Error fetching comments:",e)}}c();var b=Z(),p=d(r(b),2),x=r(p);F(x);var g=d(x,2);H(g);var u=d(g,2);u.__click=[Q,s,a,n,i];var C=r(u);{var j=e=>{var o=V();y(e,o)};T(C,e=>{l(n)&&e(j)})}var z=d(C);t(u),t(p);var v=d(p,2),A=r(v);t(v);var I=d(v,2);Y(I,21,()=>l(i),G,(e,o)=>{var f=X(),k=r(f),h=r(k),D=r(h,!0);t(h);var L=d(h,2),J=r(L,!0);t(L),t(k);var S=d(k,2),R=r(S,!0);t(S),t(f),E(()=>{m(D,l(o).username),m(J,l(o).timestamp),m(R,l(o).text)}),y(e,f)}),t(I),t(b),E(e=>{u.disabled=e,m(z,` ${l(n)?"Posting...":"Post Comment"}`),m(A,`Comments (${l(i).length??""})`)},[()=>!s.text.trim()]),M(x,()=>s.username,e=>s.username=e),M(g,()=>s.text,e=>s.text=e),y(w,b),B()}U(["click"]);export{ae as default};
